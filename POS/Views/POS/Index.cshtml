@model POS.Models.Main

@{
    Layout = null;
}
<!DOCTYPE html>
<html>
<head>
    @{
        string assets = "/Content/themes/default/assets/";
        string lang = "ltr";
        //Start Settings Table
        string theme = "default";
        string theme_style = "purple-light";
        string site_name = "SimplePOS";
        string language = "english";
        string selected_language = "en";
        bool multi_store = false;
        int default_customer = 1;
        string header = "";
        int remote_printing = 1;
        string dateformat = "D j M Y";
        int default_category = 1;
        int stripe = 0;
        string timeformat = "h:i A";
        string protocol = "mail";
        string smtp_host = "pop.gmail.com";
        string smtp_user = "noreply@spos.tecdiary.my";
        string smtp_pass = "";
        string version = "4.1.0";
        int smtp_port = 25;
        string smtp_crypto = "";
        string mailpath = "";
        string timezone = "Asia/Kuala_Lumpur";
        int setting_id = 1;
        string logo = "logo1.png";
        string default_email = "aboodcs1995@gmail.com";
        int mmode = 0;
        int captcha = 0;
        string currency_prefix = "JOD";
        string default_tax_rate = "16%";
        int rows_per_page = 10;
        int total_rows = 30;
        string footer = "";
        int bsty = 3;
        int display_kb = 0;
        int default_discount = 0;
        int item_addition = 1;
        string barcode_symbology = "";
        int pro_limit = 10;
        int decimals = 2;
        string thousands_sep = ".";
        string decimals_sep = ".";
        string focus_add_item = "ALT+F1";
        string add_customer = "ALT+F2";
        string toggle_category_slider = "ALT+F10";
        string cancel_sale = "ALT+F5";
        string suspend_sale = "ALT+F6";
        string print_order = "ALT+F11";
        string print_bill = "ALT+F12";
        string finalize_sale = "ALT+F8";
        string today_sale = "Ctrl+F1";
        string open_hold_bills = "Ctrl+F2";
        string close_register = "Ctrl+F7";
        int java_applet = 0;
        string receipt_printers = "";
        string cash_drawer_codes = "";
        int char_per_line = 42;
        int rounding = 1;
        int pin_code = 2122;
        string stripe_secret_key = "";
        string stripe_publishable_key = "";
        string purchase_code = "416de128-7cac-4ac5-a362-b980c82decff";
        string envato_username = "ACS-Techs";
        int after_sale_page = 0;
        int overselling = 1;
        int qty_decimals = 2;
        string symbol = "";
        int sac = 0;
        int display_symbol = 0;
        int remote_primting = 1;
        int printer = 1;
        string order_printers = "";
        int auto_print = 0;
        int local_printers = 1;
        int rtl = 0;
        int print_img = 0;
        string ws_barcode_type = "weight";
        int ws_barcode_chars = 13;
        int flag_chars = 1;
        int item_code_start = 2;
        int item_code_chars = 6;
        int price_start = 0;
        int price_chars = 0;
        int price_divide_by = 0;
        int weight_start = 8;
        int weight_chars = 5;
        int weight_divide_by = 100;
        //End Settings Table
    }

    <meta charset="UTF-8">
    <title>POS</title>
    <link rel="shortcut icon" href="@(assets)images/icon.png" />
    <link href="@(assets)dist/css/styles.css" rel="stylesheet" type="text/css" />
    @if(lang=="rtl")
    { 
    <link href="@(assets)dist/css/rtl.css" rel="stylesheet" />
    }
    <script src="@(assets)plugins/jQuery/jQuery-2.1.4.min.js"></script>
</head>
<body class="skin-@theme_style sidebar-collapse sidebar-mini pos">
    <div>

        <header class="main-header">
            <a href="@Url.Action("Index","Home")" class="logo">
                @if (@Model.store != null)
                {
                    <span class="logo-mini">@Model.store.code</span>
                    <span class="logo-lg">@(Model.store.name == "SimplePOS" ? "Simple<b>POS</b>" : @Model.store.name)</span>
                }
                else
                {
                    <span class="logo-mini">POS</span>
                    <span class="logo-lg">
                        @(site_name == "SimplePOS" ? "Simple<b>POS</b>" : site_name)
                    </span>
                }
            </a>
            <nav class="navbar navbar-static-top" role="navigation">
                <ul class="nav navbar-nav pull-left">
                    <li class="dropdown">
                        <a href="@Url.Action("Index","Home")" class="dropdown-toggle" data-toggle="dropdown"><img src="@(assets)/images/@(selected_language).png" alt="@selected_language"></a>
                        <ul class="dropdown-menu">
                            <li>
                                <a href="@Url.Action("SetLanguage","Language")?lang=en">
                                    <img src="@assets/images/en.png"
                                         class="language-img"> English
                                </a>
                            </li>
                        </ul>
                    </li>
                </ul>
                <div class="navbar-custom-menu">
                    <ul class="nav navbar-nav">
                        <li><a href="#" class="clock"></a></li>
                        <li><a href="@Url.Action("Index","Home")"><i class="fa fa-dashboard"></i></a></li>
                        <li><a href="@Url.Action("Settings","Home")"><i class="fa fa-cogs"></i></a></li>
                        <li><a href="@Url.Action("view_bill","POS")" target="_blank"><i class="fa fa-desktop"></i></a></li>
                        <li class="hidden-xs hidden-sm"><a href="@Url.Action("shortcuts","POS")" data-toggle="ajax"><i class="fa fa-key"></i></a></li>
                        <li><a href="@Url.Action("register_details","POS")" data-toggle="ajax">@Resources.Default.register_details</a></li>
                        <li><a href="@Url.Action("today_sale","POS")" data-toggle="ajax">@Resources.Default.today_sale</a></li>
                        <li><a href="@Url.Action("close_register","POS")" data-toggle="ajax">@Resources.Default.close_register</a></li>
                        <li class="dropdown notifications-menu" id="suspended_sales">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                <i class="fa fa-bell-o"></i>
                                <span class="label label-warning"><?=sizeof($suspended_sales);?></span>
                            </a>
                            <ul class="dropdown-menu">
                                <li class="header">
                                    <input type="text" autocomplete="off" data-list=".list-suspended-sales" name="filter-suspended-sales" id="filter-suspended-sales" class="form-control input-sm kb-text clearfix" placeholder="@Resources.Default.filter_by_reference">
                                </li>
                                <li>
                                    <ul class="menu">
                                        <li class="list-suspended-sales">
                                            <?php
                                            foreach ($suspended_sales as $ss) {
                                            echo '<a href="' . site_url('pos/?hold=' . $ss->id) . '" class="load_suspended">' . $this->tec->hrld($ss->date) . ' (' . $ss->customer_name . ')<br><div class="bold">' . $ss->hold_ref . '</div></a>';
                                            }
                                            ?>
                                        </li>
                                    </ul>
                                </li>
                                <li class="footer"><a href="@Url.Action("opened","sales")">@Resources.Default.view_all</a></li>
                            </ul>
                        </li>
                        <?php } ?>
                        <li class="dropdown user user-menu">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                <img src="<?= base_url('uploads/avatars/thumbs/' . ($this->session->userdata('avatar') ? $this->session->userdata('avatar') : $this->session->userdata('gender') . '.png')) ?>" class="user-image" alt="Avatar" />
                                <span><?= $this->session->userdata('first_name') . ' ' . $this->session->userdata('last_name'); ?></span>
                            </a>
                            <ul class="dropdown-menu">
                                <li class="user-header">
                                    <img src="<?= base_url('uploads/avatars/' . ($this->session->userdata('avatar') ? $this->session->userdata('avatar') : $this->session->userdata('gender') . '.png')) ?>" class="img-circle" alt="Avatar" />
                                    <p>
                                        <?= $this->session->userdata('email'); ?>
                                        <small><?= lang('member_since') . ' ' . $this->session->userdata('created_on'); ?></small>
                                    </p>
                                </li>
                                <li class="user-footer">
                                    <div class="pull-left">
                                        <a href="<?= site_url('users/profile/' . $this->session->userdata('user_id')); ?>" class="btn btn-default btn-flat"><?= lang('profile'); ?></a>
                                    </div>
                                    <div class="pull-right">
                                        <a href="<?= site_url('logout'); ?>" class="btn btn-default btn-flat<?= $this->session->userdata('register_id') ? ' sign_out' : ''; ?>"><?= lang('sign_out'); ?></a>
                                    </div>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <a href="#" data-toggle="control-sidebar" class="sidebar-icon"><i class="fa fa-folder sidebar-icon"></i></a>
                        </li>
                    </ul>
                </div>
            </nav>
        </header>
        @*
            <aside class="main-sidebar">
            <section class="sidebar">
                <ul class="sidebar-menu">
                    <li class="mm_welcome"><a href="<?= site_url(); ?>"><i class="fa fa-dashboard"></i> <span>@Resources.Default.Dashboard</span></a></li>
                    <?php if (@multi_store && !$this->session->userdata('store_id')) { ?>
                    <li class="mm_stores"><a href="<?= site_url('stores'); ?>"><i class="fa fa-building-o"></i> <span>@Resources.Default.Stores</span></a></li>
                    <?php } ?>
                    <li class="mm_pos"><a href="@Url.Action("POS")"><i class="fa fa-th"></i> <span>@Resources.Default.POS</span></a></li>

                    <?php if ($Admin) { ?>
                    <li class="treeview mm_products">
                        <a href="#">
                            <i class="fa fa-barcode"></i>
                            <span>@Resources.Default.Products</span>
                            <i class="fa fa-angle-left pull-right"></i>
                        </a>
                        <ul class="treeview-menu">
                            <li id="products_index"><a href="@Url.Action("Products")"><i class="fa fa-circle-o"></i> @Resources.Default.list_products</a></li>
                            <li id="products_add"><a href="@Url.Action("Add","Products")"><i class="fa fa-circle-o"></i> @Resources.Default.add_product</a></li>
                            <li id="products_import"><a href="@Url.Action("import","Products")"><i class="fa fa-circle-o"></i> @Resources.Default.import_products</a></li>
                            <li class="divider"></li>
                            <li id="products_print_barcodes"><a href="@Url.Action("print_barcodes","Products")" data-toggle="ajax"><i class="fa fa-circle-o"></i> @Resources.Default.print_barcodes</a></li>
                            <li id="products_print_labels"><a href="@Url.Action("print_labels","Products")" data-toggle="ajax"><i class="fa fa-circle-o"></i> @Resources.Default.print_labels</a></li>
                            <!-- <li id="products_print_barcodes">
                                <a onclick="window.open('<?= site_url('products/print_barcodes'); ?>', 'pos_popup', 'width=900,height=600,menubar=yes,scrollbars=yes,status=no,resizable=yes,screenx=0,screeny=0'); return false;" href="#"><i class="fa fa-circle-o"></i> <?= lang('print_barcodes'); ?></a>
                            </li>
                            <li id="products_print_labels">
                                <a onclick="window.open('<?= site_url('products/print_labels'); ?>', 'pos_popup', 'width=900,height=600,menubar=yes,scrollbars=yes,status=no,resizable=yes,screenx=0,screeny=0'); return false;" href="#"><i class="fa fa-circle-o"></i> <?= lang('print_labels'); ?></a>
                            </li> -->
                        </ul>
                    </li>
                    <li class="treeview mm_categories">
                        <a href="#">
                            <i class="fa fa-folder"></i>
                            <span>@Resources.Default.categories</span>
                            <i class="fa fa-angle-left pull-right"></i>
                        </a>
                        <ul class="treeview-menu">
                            <li id="categories_index"><a href="@Url.Action("categories")"><i class="fa fa-circle-o"></i> @Resources.Default.list_categories</a></li>
                            <li id="categories_add"><a href="@Url.Action("add","categories")"><i class="fa fa-circle-o"></i> @Resources.Default.add_category</a></li>
                            <li id="categories_import"><a href="@Url.Action("import","categories")"><i class="fa fa-circle-o"></i> @Resources.Default.import_categories</a></li>
                        </ul>
                    </li>
                    <?php if ($this->session->userdata('store_id')) { ?>
                    <li class="treeview mm_sales">
                        <a href="#">
                            <i class="fa fa-shopping-cart"></i>
                            <span>@Resources.Default.sales</span>
                            <i class="fa fa-angle-left pull-right"></i>
                        </a>
                        <ul class="treeview-menu">
                            <li id="sales_index"><a href="@Url.Action("sales")"><i class="fa fa-circle-o"></i> @Resources.Default.list_sales</a></li>
                            <li id="sales_opened"><a href="@Url.Action("opened","sales")"><i class="fa fa-circle-o"></i> @Resources.Default.list_opened_bills</a></li>
                        </ul>
                    </li>
                    <li class="treeview mm_purchases">
                        <a href="#">
                            <i class="fa fa-plus"></i>
                            <span>@Resources.Default.purchases</span>
                            <i class="fa fa-angle-left pull-right"></i>
                        </a>
                        <ul class="treeview-menu">
                            <li id="purchases_index"><a href="@Url.Action("purchases")"><i class="fa fa-circle-o"></i> @Resources.Default.list_purchases</a></li>
                            <li id="purchases_add"><a href="@Url.Action("Add","purchases")"><i class="fa fa-circle-o"></i> @Resources.Default.add_purchase</a></li>
                            <li class="divider"></li>
                            <li id="purchases_expenses"><a href="@Url.Action("expenses","purchases")"><i class="fa fa-circle-o"></i> @Resources.Default.list_expenses</a></li>
                            <li id="purchases_add_expense"><a href="@Url.Action("add_expense","purchases")"><i class="fa fa-circle-o"></i> @Resources.Default.add_expense</a></li>
                        </ul>
                    </li>
                    <?php } ?>
                    <li class="treeview mm_gift_cards">
                        <a href="#">
                            <i class="fa fa-credit-card"></i>
                            <span>@Resources.Default.gift_cards</span>
                            <i class="fa fa-angle-left pull-right"></i>
                        </a>
                        <ul class="treeview-menu">
                            <li id="gift_cards_index"><a href="@Url.Action("gift_cards")"><i class="fa fa-circle-o"></i> @Resources.Default.list_gift_cards</a></li>
                            <li id="gift_cards_add"><a href="@Url.Action("add","gift_cards")"><i class="fa fa-circle-o"></i> @Resources.Default.add_gift_card</a></li>
                        </ul>
                    </li>

                    <li class="treeview mm_auth mm_customers mm_suppliers">
                        <a href="#">
                            <i class="fa fa-users"></i>
                            <span>@Resources.Default.people</span>
                            <i class="fa fa-angle-left pull-right"></i>
                        </a>
                        <ul class="treeview-menu">
                            <li id="auth_users"><a href="@Url.Action("users")"><i class="fa fa-circle-o"></i> @Resources.Default.list_users</a></li>
                            <li id="auth_add"><a href="@Url.Action("add","users")"><i class="fa fa-circle-o"></i> @Resources.Default.add_user</a></li>
                            <li class="divider"></li>
                            <li id="customers_index"><a href="@Url.Action("customers")"><i class="fa fa-circle-o"></i> @Resources.Default.list_customers</a></li>
                            <li id="customers_add"><a href="@Url.Action("add","customers")"><i class="fa fa-circle-o"></i> @Resources.Default.add_customer</a></li>
                            <li class="divider"></li>
                            <li id="suppliers_index"><a href="@Url.Action("suppliers")"><i class="fa fa-circle-o"></i> @Resources.Default.list_suppliers</a></li>
                            <li id="suppliers_add"><a href="@Url.Action("add","suppliers")"><i class="fa fa-circle-o"></i> @Resources.Default.add_supplier</a></li>
                        </ul>
                    </li>

                    <li class="treeview mm_settings">
                        <a href="#">
                            <i class="fa fa-cogs"></i>
                            <span>@Resources.Default.settings</span>
                            <i class="fa fa-angle-left pull-right"></i>
                        </a>
                        <ul class="treeview-menu">
                            <li id="settings_index"><a href="@Url.Action("settings")"><i class="fa fa-circle-o"></i> @Resources.Default.settings</a></li>
                            <li class="divider"></li>
                            @if (multi_store)
                            {
                                <li id="settings_stores"><a href="@Url.Action("stores","settings")"><i class="fa fa-circle-o"></i> @Resources.Default.Stores</a></li>
                                <li id="settings_add_store"><a href="@Url.Action("add_store","settings")"><i class="fa fa-circle-o"></i> @Resources.Default.add_store</a></li>
                                <li class="divider"></li>
                            }
                            <li id="settings_printers"><a href="@Url.Action("printers","settings")"><i class="fa fa-circle-o"></i> @Resources.Default.printers</a></li>
                            <li id="settings_add_printer"><a href="@Url.Action("add_printer","settings")"><i class="fa fa-circle-o"></i> @Resources.Default.add_printer</a></li>
                            <li class="divider"></li>
                            <?php if ($this->db->dbdriver != 'sqlite3') { ?>
                            <li id="settings_backups"><a href="@Url.Action("backups","settings")"><i class="fa fa-circle-o"></i> @Resources.Default.backups</a></li>
                            <?php } ?>
                            <!-- <li id="settings_updates"><a href="<?= site_url('settings/updates'); ?>"><i class="fa fa-circle-o"></i> <?= lang('updates'); ?></a></li> -->
                        </ul>
                    </li>
                    <li class="treeview mm_reports">
                        <a href="#">
                            <i class="fa fa-bar-chart-o"></i>
                            <span><?= lang('reports'); ?></span>
                            <i class="fa fa-angle-left pull-right"></i>
                        </a>
                        <ul class="treeview-menu">
                            <li id="reports_daily_sales"><a href="<?= site_url('reports/daily_sales'); ?>"><i class="fa fa-circle-o"></i> <?= lang('daily_sales'); ?></a></li>
                            <li id="reports_monthly_sales"><a href="<?= site_url('reports/monthly_sales'); ?>"><i class="fa fa-circle-o"></i> <?= lang('monthly_sales'); ?></a></li>
                            <li id="reports_index"><a href="<?= site_url('reports'); ?>"><i class="fa fa-circle-o"></i> <?= lang('sales_report'); ?></a></li>
                            <li class="divider"></li>
                            <li id="reports_payments"><a href="<?= site_url('reports/payments'); ?>"><i class="fa fa-circle-o"></i> <?= lang('payments_report'); ?></a></li>
                            <li class="divider"></li>
                            <li id="reports_registers"><a href="<?= site_url('reports/registers'); ?>"><i class="fa fa-circle-o"></i> <?= lang('registers_report'); ?></a></li>
                            <li class="divider"></li>
                            <li id="reports_top_products"><a href="<?= site_url('reports/top_products'); ?>"><i class="fa fa-circle-o"></i> <?= lang('top_products'); ?></a></li>
                            <li id="reports_products"><a href="<?= site_url('reports/products'); ?>"><i class="fa fa-circle-o"></i> <?= lang('products_report'); ?></a></li>
                        </ul>
                    </li>
                    <?php } else { ?>
                    <li class="mm_products"><a href="<?= site_url('products'); ?>"><i class="fa fa-barcode"></i> <span><?= lang('products'); ?></span></a></li>
                    <li class="mm_categories"><a href="<?= site_url('categories'); ?>"><i class="fa fa-folder-open"></i> <span><?= lang('categories'); ?></span></a></li>
                    <?php if ($this->session->userdata('store_id')) { ?>
                    <li class="treeview mm_sales">
                        <a href="#">
                            <i class="fa fa-shopping-cart"></i>
                            <span><?= lang('sales'); ?></span>
                            <i class="fa fa-angle-left pull-right"></i>
                        </a>
                        <ul class="treeview-menu">
                            <li id="sales_index"><a href="<?= site_url('sales'); ?>"><i class="fa fa-circle-o"></i> <?= lang('list_sales'); ?></a></li>
                            <li id="sales_opened"><a href="<?= site_url('sales/opened'); ?>"><i class="fa fa-circle-o"></i> <?= lang('list_opened_bills'); ?></a></li>
                        </ul>
                    </li>
                    <li class="treeview mm_purchases">
                        <a href="#">
                            <i class="fa fa-plus"></i>
                            <span><?= lang('expenses'); ?></span>
                            <i class="fa fa-angle-left pull-right"></i>
                        </a>
                        <ul class="treeview-menu">
                            <li id="purchases_expenses"><a href="<?= site_url('purchases/expenses'); ?>"><i class="fa fa-circle-o"></i> <?= lang('list_expenses'); ?></a></li>
                            <li id="purchases_add_expense"><a href="<?= site_url('purchases/add_expense'); ?>"><i class="fa fa-circle-o"></i> <?= lang('add_expense'); ?></a></li>
                        </ul>
                    </li>
                    <?php } ?>
                    <li class="treeview mm_gift_cards">
                        <a href="#">
                            <i class="fa fa-credit-card"></i>
                            <span><?= lang('gift_cards'); ?></span>
                            <i class="fa fa-angle-left pull-right"></i>
                        </a>
                        <ul class="treeview-menu">
                            <li id="gift_cards_index"><a href="<?= site_url('gift_cards'); ?>"><i class="fa fa-circle-o"></i> <?= lang('list_gift_cards'); ?></a></li>
                            <li id="gift_cards_add"><a href="<?= site_url('gift_cards/add'); ?>"><i class="fa fa-circle-o"></i> <?= lang('add_gift_card'); ?></a></li>
                        </ul>
                    </li>
                    <li class="treeview mm_customers">
                        <a href="#">
                            <i class="fa fa-users"></i>
                            <span><?= lang('customers'); ?></span>
                            <i class="fa fa-angle-left pull-right"></i>
                        </a>
                        <ul class="treeview-menu">
                            <li id="customers_index"><a href="<?= site_url('customers'); ?>"><i class="fa fa-circle-o"></i> <?= lang('list_customers'); ?></a></li>
                            <li id="customers_add"><a href="<?= site_url('customers/add'); ?>"><i class="fa fa-circle-o"></i> <?= lang('add_customer'); ?></a></li>
                        </ul>
                    </li>
                    <?php } ?>
                </ul>
            </section>
        </aside>
        *@


    <div class="content-wrapper">
        @*

                    <div class="col-lg-12 alerts">
            <?php if ($error) { ?>
            <div class="alert alert-danger alert-dismissable">
                <button aria-hidden="true" data-dismiss="alert" class="close" type="button">×</button>
                <h4><i class="icon fa fa-ban"></i> <?= lang('error'); ?></h4>
                <?= $error; ?>
            </div>
            <?php } if ($message) { ?>
            <div class="alert alert-success alert-dismissable">
                <button aria-hidden="true" data-dismiss="alert" class="close" type="button">×</button>
                <h4><i class="icon fa fa-check"></i> <?= lang('Success'); ?></h4>
                <?= $message; ?>
            </div>
            <?php } ?>
        </div>*@


        <table style="width:100%;" class="layout-table">
            <tr>
                <td style="width: 460px;">

                    <div id="pos">
                        <?= form_open('pos', 'id="pos-sale-form"'); ?>
                        <div class="well well-sm" id="leftdiv">
                            <div id="lefttop" style="margin-bottom:5px;">
                                <div class="form-group" style="margin-bottom:5px;">
                                    <div class="input-group">
                                        <?php foreach ($customers as $customer) {
                                        $cus[$customer->id] = $customer->name;
                                        } ?>
                                        <?= form_dropdown('customer_id', $cus, set_value('customer_id', @default_customer), 'id="spos_customer" data-placeholder="' . lang('select') . ' ' . lang('customer') . '" required="required" class="form-control select2" style="width:100%;position:absolute;"'); ?>
                                        <div class="input-group-addon no-print" style="padding: 2px 5px;">
                                            <a href="#" id="add-customer" class="external" data-toggle="modal" data-target="#myModal"><i class="fa fa-2x fa-plus-circle" id="addIcon"></i></a>
                                        </div>
                                    </div>
                                    <div style="clear:both;"></div>
                                </div>
                                <?php if ($eid && $Admin) { ?>
                                <div class="form-group" style="margin-bottom:5px;">
                                    <?= form_input('date', set_value('date', $sale->date), 'id="date" required="required" class="form-control"'); ?>
                                </div>
                                <?php } ?>
                                <div class="form-group" style="margin-bottom:5px;">
                                    <input type="text" name="hold_ref" value="<?= $reference_note; ?>" id="hold_ref" class="form-control kb-text" placeholder="<?=lang('reference_note')?>" />
                                </div>
                                <div class="form-group" style="margin-bottom:5px;">
                                    <input type="text" name="code" id="add_item" class="form-control" placeholder="<?=lang('search__scan')?>" />
                                </div>
                            </div>
                            <div id="printhead" class="print">
                                <?= @header ?>
                                <p><?= lang('date'); ?>: <?=date(@dateformat)?></p>
                            </div>
                            <div id="print" class="fixed-table-container">
                                <div id="list-table-div">
                                    <div class="fixed-table-header">
                                        <table class="table table-striped table-condensed table-hover list-table" style="margin:0;">
                                            <thead>
                                                <tr class="success">
                                                    <th><?=lang('product')?></th>
                                                    <th style="width: 15%;text-align:center;">@Resources.Default.price</th>
                                                    <th style="width: 15%;text-align:center;">@Resources.Default.qty</th>
                                                    <th style="width: 20%;text-align:center;">@Resources.Default.subtotal</th>
                                                    <th style="width: 20px;" class="satu"><i class="fa fa-trash-o"></i></th>
                                                </tr>
                                            </thead>
                                        </table>
                                    </div>
                                    <table id="posTable" class="table table-striped table-condensed table-hover list-table" style="margin:0px;" data-height="100">
                                        <thead>
                                            <tr class="success">
                                                <th><?=lang('product')?></th>
                                                <th style="width: 15%;text-align:center;">@Resources.Default.price</th>
                                                <th style="width: 15%;text-align:center;">@Resources.Default.qty</th>
                                                <th style="width: 20%;text-align:center;">@Resources.Default.subtotal</th>
                                                <th style="width: 20px;" class="satu"><i class="fa fa-trash-o"></i></th>
                                            </tr>
                                        </thead>
                                        <tbody></tbody>
                                    </table>
                                </div>
                                <div style="clear:both;"></div>
                                <div id="totaldiv">
                                    <table id="totaltbl" class="table table-condensed totals" style="margin-bottom:10px;">
                                        <tbody>
                                            <tr class="info">
                                                <td width="25%">@Resources.Default.total_items</td>
                                                <td class="text-right" style="padding-right:10px;"><span id="count">0</span></td>
                                                <td width="25%">@Resources.Default.total</td>
                                                <td class="text-right" colspan="2"><span id="total">0</span></td>
                                            </tr>
                                            <tr class="info">
                                                <td width="25%"><a href="#" id="add_discount">@Resources.Default.discount</a></td>
                                                <td class="text-right" style="padding-right:10px;"><span id="ds_con">0</span></td>
                                                <td width="25%"><a href="#" id="add_tax">@Resources.Default.order_tax</a></td>
                                                <td class="text-right"><span id="ts_con">0</span></td>
                                            </tr>
                                            <tr class="success">
                                                <td colspan="2" style="font-weight:bold;">
                                                    @Resources.Default.total_payable
                                                    <a role="button" data-toggle="modal" data-target="#noteModal">
                                                        <i class="fa fa-comment"></i>
                                                    </a>
                                                </td>
                                                <td class="text-right" colspan="2" style="font-weight:bold;"><span id="total-payable">0</span></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <div id="botbuttons" class="col-xs-12 text-center">
                                <div class="row">
                                    <div class="col-xs-4" style="padding: 0;">
                                        <div class="btn-group-vertical btn-block">
                                            <button type="button" class="btn btn-warning btn-block btn-flat"
                                                    id="suspend">
                                                @Resources.Default.hold
                                            </button>
                                            <button type="button" class="btn btn-danger btn-block btn-flat"
                                                    id="reset">
                                                @Resources.Default.cancel
                                            </button>
                                        </div>

                                    </div>
                                    <div class="col-xs-4" style="padding: 0 5px;">
                                        <div class="btn-group-vertical btn-block">
                                            <button type="button" class="btn bg-purple btn-block btn-flat" id="print_order">@Resources.Default.print_order</button>

                                            <button type="button" class="btn bg-navy btn-block btn-flat" id="print_bill">@Resources.Default.print_bill</button>
                                        </div>
                                    </div>
                                    <div class="col-xs-4" style="padding: 0;">
                                        <button type="button" class="btn btn-success btn-block btn-flat" id="<?= $eid ? 'submit-sale' : 'payment'; ?>" style="height:67px;"><?= $eid ? @Resources.Default.submit : @Resources.Default.payment; ?></button>
                                    </div>
                                </div>

                            </div>
                            <div class="clearfix"></div>
                            <span id="hidesuspend"></span>
                            <input type="hidden" name="spos_note" value="" id="spos_note">

                            <div id="payment-con">
                                <input type="hidden" name="amount" id="amount_val" value="<?= $eid ? $sale->paid : ''; ?>" />
                                <input type="hidden" name="balance_amount" id="balance_val" value="" />
                                <input type="hidden" name="paid_by" id="paid_by_val" value="cash" />
                                <input type="hidden" name="cc_no" id="cc_no_val" value="" />
                                <input type="hidden" name="paying_gift_card_no" id="paying_gift_card_no_val" value="" />
                                <input type="hidden" name="cc_holder" id="cc_holder_val" value="" />
                                <input type="hidden" name="cheque_no" id="cheque_no_val" value="" />
                                <input type="hidden" name="cc_month" id="cc_month_val" value="" />
                                <input type="hidden" name="cc_year" id="cc_year_val" value="" />
                                <input type="hidden" name="cc_type" id="cc_type_val" value="" />
                                <input type="hidden" name="cc_cvv2" id="cc_cvv2_val" value="" />
                                <input type="hidden" name="balance" id="balance_v" value="" />
                                <input type="hidden" name="payment_note" id="payment_note_val" value="" />
                            </div>
                            <input type="hidden" name="customer" id="customer" value="@default_customer" />
                            <input type="hidden" name="order_tax" id="tax_val" value="" />
                            <input type="hidden" name="order_discount" id="discount_val" value="" />
                            <input type="hidden" name="count" id="total_item" value="" />
                            <input type="hidden" name="did" id="did_delete" value="<?=$sid;?>" />
                            <input type="hidden" name="eid" id="eid_delete" value="<?=$eid;?>" />
                            <input type="hidden" name="total_items" id="total_items" value="0" />
                            <input type="hidden" name="total_quantity" id="total_quantity" value="0" />
                            <input type="submit" id="submit" value="Submit Sale" style="display: none;" />
                        </div>
                        <?=form_close();?>
                    </div>

                </td>
                <td>
                    <div class="contents" id="right-col">
                        <div id="item-list">
                            <div class="items">
                                <?php echo $products; ?>
                            </div>
                        </div>
                        <div class="product-nav">
                            <div class="btn-group btn-group-justified">
                                <div class="btn-group">
                                    <button style="z-index:10002;" class="btn btn-warning pos-tip btn-flat" type="button" id="previous"><i class="fa fa-chevron-left"></i></button>
                                </div>
                                <div class="btn-group">
                                    <button style="z-index:10003;" class="btn btn-success pos-tip btn-flat" type="button" id="sellGiftCard"><i class="fa fa-credit-card" id="addIcon"></i> @Resources.Default.sell_gift_card</button>
                                </div>
                                <div class="btn-group">
                                    <button style="z-index:10004;" class="btn btn-warning pos-tip btn-flat" type="button" id="next"><i class="fa fa-chevron-right"></i></button>
                                </div>
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </table>
    </div>
    </div>

    <aside class="control-sidebar control-sidebar-dark" id="categories-list">
        <div class="tab-content sb">
            <div class="tab-pane active sb" id="control-sidebar-home-tab">
                <div id="filter-categories-con">
                    <input type="text" autocomplete="off" data-list=".control-sidebar-menu" name="filter-categories" id="filter-categories" class="form-control sb col-xs-12 kb-text" placeholder="<?= lang('filter_categories'); ?>" style="margin-bottom: 20px;">
                </div>
                <div class="clearfix sb"></div>
                <div id="category-sidebar-menu">
                    <ul class="control-sidebar-menu">
                        <?php
                        foreach ($categories as $category) {
                        echo '
                        <li>
                            <a href="#" class="category' . ($category->id == @default_category ? ' active' : '') . '" id="' . $category->id . '">
                                ';
                                if ($category->image) {
                                echo '<div class="menu-icon"><img src="' . base_url('uploads/thumbs/' . $category->image) . '" alt="" class="img-thumbnail img-responsive"></div>';
                                } else {
                                echo '<i class="menu-icon fa fa-folder-open bg-red"></i>';
                                }
                                echo '<div class="menu-info"><h4 class="control-sidebar-subheading">' . $category->code . '</h4><p>' . $category->name . '</p></div>
                            </a>
                        </li>';
                        }
                        ?>
                    </ul>
                </div>
            </div>
        </div>
    </aside>
    <div class="control-sidebar-bg sb"></div>
    <div id="order_tbl" style="display:none;">
        <span id="order_span"></span>
        <table id="order-table" class="prT table table-condensed" style="width:100%;margin-bottom:0;"></table>
    </div>
    <div id="bill_tbl" style="display:none;">
        <span id="bill_span"></span>
        <table id="bill-table" width="100%" class="prT table table-condensed" style="width:100%;margin-bottom:0;"></table>
        <table id="bill-total-table" width="100%" class="prT table table-condensed" style="width:100%;margin-bottom:0;"></table>
    </div>
    <div style="width:435px;background:#FFF;display:block">
        <div id="order-data" style="display:none;" class="text-center">
            <h1><?= $store->name; ?></h1>
            <h2>@Resources.Default.order</h2>
            <div id="preo" class="text-left"></div>
        </div>
        <div id="bill-data" style="display:none;" class="text-center">
            <h1><?= $store->name; ?></h1>
            <h2>@Resources.Default.bill</h2>
            <div id="preb" class="text-left"></div>
        </div>
    </div>

    <div id="ajaxCall"><i class="fa fa-spinner fa-pulse"></i></div>

    <div class="modal" data-easein="flipYIn" id="gcModal" tabindex="-1" role="dialog" aria-labelledby="mModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true"><i class="fa fa-times"></i></button>
                    <h4 class="modal-title" id="myModalLabel">@Resources.Default.sell_gift_card</h4>
                </div>
                <div class="modal-body">
                    <p>@Resources.Default.enter_info</p>

                    <div class="alert alert-danger gcerror-con" style="display: none;">
                        <button data-dismiss="alert" class="close" type="button">×</button>
                        <span id="gcerror"></span>
                    </div>
                    <div class="form-group">
                        <?= lang('card_no', 'gccard_no'); ?> *
                        <div class="input-group">
                            <?php echo form_input('gccard_no', '', 'class="form-control" id="gccard_no"'); ?>
                            <div class="input-group-addon" style="padding-left: 10px; padding-right: 10px;"><a href="#" id="genNo"><i class="fa fa-cogs"></i></a></div>
                        </div>
                    </div>
                    <input type="hidden" name="gcname" value="<?= lang('gift_card') ?>" id="gcname" />
                    <div class="form-group">
                        <?= lang('value', 'gcvalue'); ?> *
                        <?php echo form_input('gcvalue', '', 'class="form-control" id="gcvalue"'); ?>
                    </div>
                    <div class="form-group">
                        <?= lang('price', 'gcprice'); ?> *
                        <?php echo form_input('gcprice', '', 'class="form-control" id="gcprice"'); ?>
                    </div>
                    <div class="form-group">
                        <?= lang('expiry_date', 'gcexpiry'); ?>
                        <?php echo form_input('gcexpiry', '', 'class="form-control" id="gcexpiry"'); ?>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default pull-left" data-dismiss="modal">@Resources.Default.close</button>
                    <button type="button" id="addGiftCard" class="btn btn-primary">@Resources.Default.sell_gift_card</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal" data-easein="flipYIn" id="dsModal" tabindex="-1" role="dialog" aria-labelledby="dsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-sm">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true"><i class="fa fa-times"></i></button>
                    <h4 class="modal-title" id="dsModalLabel">@Resources.Default.discount_title</h4>
                </div>
                <div class="modal-body">
                    <input type='text' class='form-control input-sm kb-pad' id='get_ds' onClick='this.select();' value=''>

                    <label class="checkbox" for="apply_to_order">
                        <input type="radio" name="apply_to" value="order" id="apply_to_order" checked="checked" />
                        @Resources.Default.apply_to_order
                    </label>
                    <label class="checkbox" for="apply_to_products">
                        <input type="radio" name="apply_to" value="products" id="apply_to_products" />
                        @Resources.Default.apply_to_products
                    </label>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default btn-sm pull-left" data-dismiss="modal">@Resources.Default.close</button>
                    <button type="button" id="updateDiscount" class="btn btn-primary btn-sm">@Resources.Default.update</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal" data-easein="flipYIn" id="tsModal" tabindex="-1" role="dialog" aria-labelledby="tsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-sm">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true"><i class="fa fa-times"></i></button>
                    <h4 class="modal-title" id="tsModalLabel">@Resources.Default.tax_title</h4>
                </div>
                <div class="modal-body">
                    <input type='text' class='form-control input-sm kb-pad' id='get_ts' onClick='this.select();' value=''>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default btn-sm pull-left" data-dismiss="modal">@Resources.Default.close</button>
                    <button type="button" id="updateTax" class="btn btn-primary btn-sm">@Resources.Default.update</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal" data-easein="flipYIn" id="noteModal" tabindex="-1" role="dialog" aria-labelledby="noteModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-sm">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true"><i class="fa fa-times"></i></button>
                    <h4 class="modal-title" id="noteModalLabel">@Resources.Default.note</h4>
                </div>
                <div class="modal-body">
                    <textarea name="snote" id="snote" class="pa form-control kb-text"></textarea>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default btn-sm pull-left" data-dismiss="modal">@Resources.Default.close</button>
                    <button type="button" id="update-note" class="btn btn-primary btn-sm">@Resources.Default.update</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal" data-easein="flipYIn" id="proModal" tabindex="-1" role="dialog" aria-labelledby="proModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header modal-primary">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true"><i class="fa fa-times"></i></button>
                    <h4 class="modal-title" id="proModalLabel">
                        <?=lang('payment')?>
                    </h4>
                </div>
                <div class="modal-body">
                    <table class="table table-bordered table-striped">
                        <tr>
                            <th style="width:25%;">@Resources.Default.net_price</th>
                            <th style="width:25%;"><span id="net_price"></span></th>
                            <th style="width:25%;">@Resources.Default.product_tax</th>
                            <th style="width:25%;"><span id="pro_tax"></span> <span id="pro_tax_method"></span></th>
                        </tr>
                    </table>
                    <input type="hidden" id="row_id" />
                    <input type="hidden" id="item_id" />
                    <div class="row">
                        <div class="col-sm-6">
                            <div class="form-group">
                                <?=lang('unit_price', 'nPrice')?>
                                <input type="text" class="form-control input-sm kb-pad" id="nPrice" onClick="this.select();" placeholder="@Resources.Default.new_price">
                            </div>
                            <div class="form-group">
                                <?=lang('discount', 'nDiscount')?>
                                <input type="text" class="form-control input-sm kb-pad" id="nDiscount" onClick="this.select();" placeholder="@Resources.Default.discount">
                            </div>
                        </div>
                        <div class="col-sm-6">
                            <div class="form-group">
                                <?=lang('quantity', 'nQuantity')?>
                                <input type="text" class="form-control input-sm kb-pad" id="nQuantity" onClick="this.select();" placeholder="@Resources.Default.current_quantity">
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="form-group">
                                <?=lang('comment', 'nComment')?>
                                <textarea class="form-control kb-text" id="nComment"></textarea>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default pull-left" data-dismiss="modal">@Resources.Default.close</button>
                    <button class="btn btn-success" id="editItem">@Resources.Default.update</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal" data-easein="flipYIn" id="susModal" tabindex="-1" role="dialog" aria-labelledby="susModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true"><i class="fa fa-times"></i></button>
                    <h4 class="modal-title" id="susModalLabel">@Resources.Default.suspend_sale</h4>
                </div>
                <div class="modal-body">
                    <p>@Resources.Default.type_reference_note</p>

                    <div class="form-group">
                        @Resources.Default.reference_note
                        <?php echo form_input('reference_note', $reference_note, 'class="form-control kb-text" id="reference_note"'); ?>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default pull-left" data-dismiss="modal"> @Resources.Default.close </button>
                    <button type="button" id="suspend_sale" class="btn btn-primary">@Resources.Default.submit</button>
                </div>
            </div>
        </div>
    </div>



    <div class="modal" data-easein="flipYIn" id="saleModal" tabindex="-1" role="dialog" aria-labelledby="saleModalLabel" aria-hidden="true"></div>
    <div class="modal" data-easein="flipYIn" id="opModal" tabindex="-1" role="dialog" aria-labelledby="opModalLabel" aria-hidden="true"></div>

    <div class="modal" data-easein="flipYIn" id="payModal" tabindex="-1" role="dialog" aria-labelledby="payModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-success">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true"><i class="fa fa-times"></i></button>
                    <h4 class="modal-title" id="payModalLabel">
                        @Resources.Default.payment
                    </h4>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-xs-9">
                            <div class="font16">
                                <table class="table table-bordered table-condensed" style="margin-bottom: 0;">
                                    <tbody>
                                        <tr>
                                            <td width="25%" style="border-right-color: #FFF !important;">@Resources.Default.total_items</td>
                                            <td width="25%" class="text-right"><span id="item_count">0.00</span></td>
                                            <td width="25%" style="border-right-color: #FFF !important;">@Resources.Default.total_payable</td>
                                            <td width="25%" class="text-right"><span id="twt">0.00</span></td>
                                        </tr>
                                        <tr>
                                            <td style="border-right-color: #FFF !important;">@Resources.Default.total_paying</td>
                                            <td class="text-right"><span id="total_paying">0.00</span></td>
                                            <td style="border-right-color: #FFF !important;">@Resources.Default.balance</td>
                                            <td class="text-right"><span id="balance">0.00</span></td>
                                        </tr>
                                    </tbody>
                                </table>
                                <div class="clearfix"></div>
                            </div>
                            <div class="row">
                                <div class="col-xs-12">
                                    <div class="form-group">
                                        @Resources.Default.note
                                        <textarea name="note" id="note" class="pa form-control kb-text"></textarea>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-xs-6">
                                    <div class="form-group">
                                        @Resources.Default.amount
                                        <input name="amount" type="text" id="amount"
                                               class="pa form-control kb-pad amount" />
                                    </div>
                                </div>
                                <div class="col-xs-6">
                                    <div class="form-group">
                                        <?= lang('paying_by', 'paid_by'); ?>
                                        <select id="paid_by" class="form-control paid_by select2" style="width:100%;">
                                            <option value="cash">@Resources.Default.cash</option>
                                            <option value="CC">@Resources.Default.cc</option>
                                            <option value="cheque">@Resources.Default.cheque</option>
                                            <option value="gift_card">@Resources.Default.gift_card</option>
                                            <?= isset(@stripe) ? '
                                        <option value="stripe">' . @Resources.Default.stripe . '</option>' : ''; ?>
                                        <option value="other">@Resources.Default.other</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-xs-12">
                                    <div class="form-group gc" style="display: none;">
                                        @Resources.Default.gift_card_no
                                        <input type="text" id="gift_card_no"
                                               class="pa form-control kb-pad gift_card_no gift_card_input" />

                                        <div id="gc_details"></div>
                                    </div>
                                    <div class="pcc" style="display:none;">
                                        <div class="form-group">
                                            <input type="text" id="swipe" class="form-control swipe swipe_input"
                                                   placeholder="@Resources.Default.focus_swipe_here" />
                                        </div>
                                        <div class="row">
                                            <div class="col-xs-6">
                                                <div class="form-group">
                                                    <input type="text" id="pcc_no"
                                                           class="form-control kb-pad"
                                                           placeholder="@Resources.Default.cc_no" />
                                                </div>
                                            </div>
                                            <div class="col-xs-6">
                                                <div class="form-group">

                                                    <input type="text" id="pcc_holder"
                                                           class="form-control kb-text"
                                                           placeholder="@Resources.Default.cc_holder" />
                                                </div>
                                            </div>
                                            <div class="col-xs-3">
                                                <div class="form-group">
                                                    <select id="pcc_type"
                                                            class="form-control pcc_type select2"
                                                            placeholder="@Resources.Default.card_type">
                                                        <option value="Visa">@Resources.Default.visa</option>
                                                        <option value="MasterCard">
                                                            @Resources.Default.master_card
                                                        </option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="col-xs-3">
                                                <div class="form-group">
                                                    <input type="text" id="pcc_month"
                                                           class="form-control kb-pad"
                                                           placeholder="Expirey date" />
                                                </div>
                                            </div>
                                            <div class="col-xs-3">
                                                <div class="form-group">

                                                    <input type="text" id="pcc_cvv2"
                                                           class="form-control kb-pad"
                                                           placeholder="@Resources.Default.cvv2" />
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="pcheque" style="display:none;">
                                        <div class="form-group">
                                            @Resources.Default.cheque_no
                                            <input type="text" id="cheque_no"
                                                   class="form-control cheque_no kb-text" />
                                        </div>
                                    </div>
                                    <div class="pcash">
                                        <div class="form-group">
                                            @Resources.Default.payment_note
                                            <input type="text" id="payment_note"
                                                   class="form-control payment_note kb-text" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-xs-3 text-center">
                            <!-- <span style="font-size: 1.2em; font-weight: bold;"><?= lang('quick_cash'); ?></span> -->

                            <div class="btn-group btn-group-vertical" style="width:100%;">
                                <button type="button" class="btn btn-info btn-block quick-cash" id="quick-payable">
                                    0.00
                                </button>
                                <?php
                                foreach (lang('quick_cash_notes') as $cash_note_amount) {
                                echo '<button type="button" class="btn btn-block btn-warning quick-cash">' . $cash_note_amount . '</button>';
                                }
                                ?>
                                      <button type="button" class="btn btn-block btn-danger"
                                              id="clear-cash-notes">
                                          @Resources.Default.payment_note
                                      </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default pull-left" data-dismiss="modal">@Resources.Default.close</button>
                    <button class="btn btn-primary" id="<?= $eid ? '' : 'submit-sale'; ?>">@Resources.Default.submit</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal" data-easein="flipYIn" id="customerModal" tabindex="-1" role="dialog" aria-labelledby="cModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header modal-primary">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true"><i class="fa fa-times"></i></button>
                    <h4 class="modal-title" id="cModalLabel">
                        @Resources.Default.add_customer
                    </h4>
                </div>
                <?= form_open('pos/add_customer', 'id="customer-form"'); ?>
                <div class="modal-body">
                    <div id="c-alert" class="alert alert-danger" style="display:none;"></div>
                    <div class="row">
                        <div class="col-xs-12">
                            <div class="form-group">
                                <label class="control-label" for="code">
                                    @Resources.Default.name
                                </label>
                                <input name="name" class="form-control input-sm kb-text" id="cname" type="text" />
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-xs-6">
                            <div class="form-group">
                                <label class="control-label" for="cemail">
                                    @Resources.Default.email_address
                                </label>
                                <input name="email" class="form-control input-sm kb-text" id="cemail" type="email" />
                                <?= form_input('email', '', 'class="form-control input-sm kb-text" id="cemail"'); ?>
                            </div>
                        </div>
                        <div class="col-xs-6">
                            <div class="form-group">
                                <label class="control-label" for="phone">
                                    @Resources.Default.phone
                                </label>
                                <input name="phone" class="form-control input-sm kb-pad" id="cphone" type="tel" />
                                <?= form_input('phone', '', 'class="form-control input-sm kb-pad" id="cphone"');?>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-xs-6">
                            <div class="form-group">
                                <label class="control-label" for="cf1">
                                    @Resources.Default.cf1
                                </label>
                                <input name="cf1" class="form-control input-sm kb-text" id="cf1" type="text" />
                                <?= form_input('cf1', '', 'class="form-control input-sm kb-text" id="cf1"'); ?>
                            </div>
                        </div>
                        <div class="col-xs-6">
                            <div class="form-group">
                                <label class="control-label" for="cf2">
                                    @Resources.Default.cf2
                                </label>
                                <input name="cf2" class="form-control input-sm kb-text" id="cf2" type="text" />
                                <?= form_input('cf2', '', 'class="form-control input-sm kb-text" id="cf2"');?>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="modal-footer" style="margin-top:0;">
                    <button type="button" class="btn btn-default pull-left" data-dismiss="modal">@Resources.Default.close</button>
                    <button type="submit" class="btn btn-primary" id="add_customer">@Resources.Default.add_customer</button>
                </div>
                <?= form_close(); ?>
            </div>
        </div>
    </div>

    <div class="modal" data-easein="flipYIn" id="printModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog" style="width:400px;">
            <div class="modal-content">
                <div class="modal-header np">
                    <button type="button" class="close" id="print-modal-close" data-dismiss="modal" aria-hidden="true"><i class="fa fa-times"></i></button>
                    <button type="button" class="close mr10" onclick="window.print();"><i class="fa fa-print"></i></button>
                    <h4 class="modal-title" id="print-title"></h4>
                </div>
                <div class="modal-body">
                    <div id="print-body"></div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal" data-easein="flipYIn" id="posModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"></div>
    <div class="modal" data-easein="flipYIn" id="posModal2" tabindex="-1" role="dialog" aria-labelledby="myModalLabel2" aria-hidden="true"></div>

    <script type="text/javascript">
    var base_url = '<?=base_url();?>', assets = '@(assets)';
    var dateformat = '@(dateformat)', timeformat = '@(timeformat)';
    <?php unset(@protocol, @smtp_host, @smtp_user, @smtp_pass, @smtp_port, @smtp_crypto, @mailpath, @timezone, @setting_id, @default_email, @version, @stripe, @stripe_secret_key, @stripe_publishable_key); ?>
    var Settings = <?= json_encode($Settings); ?>;
    var sid = false, username = '<?=$this->session->userdata('username');?>', spositems = {};
    $(window).load(function () {
        $('#mm_<?=$m?>').addClass('active');
        $('#<?=$m?>_<?=$v?>').addClass('active');
    });
    var pro_limit = <?=@pro_limit?>, java_applet = 0, count = 1, total = 0, an = 1, p_page = 0, page = 0, cat_id = <?=@default_category?>, tcp = <?=$tcp?>;
    var gtotal = 0, order_discount = 0, order_tax = 0, protect_delete = <?= ($Admin) ? 0 : (@pin_code ? 1 : 0); ?>;
    var order_data = {}, bill_data = {};
    var csrf_hash = '<?= $this->security->get_csrf_hash(); ?>';
    <?php
    if (@remote_printing == 2) {
        ?>
        var ob_store_name = "<?= printText($store->name, (!empty($printer) ? $printer->char_per_line : '')); ?>\r\n";
        order_data.store_name = ob_store_name;
        bill_data.store_name = ob_store_name;

        ob_header = "";
        ob_header += "<?= printText($store->name . ' (' . $store->code . ')', (!empty($printer) ? $printer->char_per_line : '')); ?>\r\n";
        <?php
        if ($store->address1) { ?>
            ob_header += "<?= printText($store->address1, (!empty($printer) ? $printer->char_per_line : ''));?>\r\n";
            <?php
        }
        if ($store->address2) { ?>
            ob_header += "<?= printText($store->address2, (!empty($printer) ? $printer->char_per_line : ''));?>\r\n";
            <?php
        }
        if ($store->city) { ?>
            ob_header += "<?= printText($store->city, (!empty($printer) ? $printer->char_per_line : ''));?>\r\n";
            <?php
        } ?>
        ob_header += "<?= printText(lang('tel') . ': ' . $store->phone, (!empty($printer) ? $printer->char_per_line : '')); ?>\r\n\r\n";
        ob_header += "<?= printText(str_replace(["\n", "\r"], ['\\n', '\\r'], $store->receipt_header), (!empty($printer) ? $printer->char_per_line : '')); ?>\r\n\r\n";

        order_data.header = ob_header + "<?= printText(lang('order'), (!empty($printer) ? $printer->char_per_line : '')); ?>\r\n\r\n";
        bill_data.header = ob_header + "<?= printText(lang('bill'), (!empty($printer) ? $printer->char_per_line : '')); ?>\r\n\r\n";
        order_data.totals = '';
        order_data.payments = '';
        bill_data.payments = '';
        order_data.footer = '';
        bill_data.footer = "<?= lang('merchant_copy'); ?> \n";
        <?php
    }
    ?>
    var lang = new Array();
    lang['code_error'] = '<?= lang('code_error'); ?>';
    lang['r_u_sure'] = '<?= lang('r_u_sure'); ?>';
    lang['please_add_product'] = '<?= lang('please_add_product'); ?>';
    lang['paid_less_than_amount'] = '<?= lang('paid_less_than_amount'); ?>';
    lang['x_suspend'] = '<?= lang('x_suspend'); ?>';
    lang['discount_title'] = '<?= lang('discount_title'); ?>';
    lang['update'] = '<?= lang('update'); ?>';
    lang['tax_title'] = '<?= lang('tax_title'); ?>';
    lang['leave_alert'] = '<?= lang('leave_alert'); ?>';
    lang['close'] = '<?= lang('close'); ?>';
    lang['delete'] = '<?= lang('delete'); ?>';
    lang['no_match_found'] = '<?= lang('no_match_found'); ?>';
    lang['wrong_pin'] = '<?= lang('wrong_pin'); ?>';
    lang['file_required_fields'] = '<?= lang('file_required_fields'); ?>';
    lang['enter_pin_code'] = '<?= lang('enter_pin_code'); ?>';
    lang['incorrect_gift_card'] = '<?= lang('incorrect_gift_card'); ?>';
    lang['card_no'] = '<?= lang('card_no'); ?>';
    lang['value'] = '<?= lang('value'); ?>';
    lang['balance'] = '<?= lang('balance'); ?>';
    lang['unexpected_value'] = '<?= lang('unexpected_value'); ?>';
    lang['inclusive'] = '<?= lang('inclusive'); ?>';
    lang['exclusive'] = '<?= lang('exclusive'); ?>';
    lang['total'] = '<?= lang('total'); ?>';
    lang['total_items'] = '<?= lang('total_items'); ?>';
    lang['order_tax'] = '<?= lang('order_tax'); ?>';
    lang['order_discount'] = '<?= lang('order_discount'); ?>';
    lang['total_payable'] = '<?= lang('total_payable'); ?>';
    lang['rounding'] = '<?= lang('rounding'); ?>';
    lang['grand_total'] = '<?= lang('grand_total'); ?>';
    lang['register_open_alert'] = '<?= lang('register_open_alert'); ?>';
    lang['discount'] = '<?= lang('discount'); ?>';
    lang['order'] = '<?= lang('order'); ?>';
    lang['bill'] = '<?= lang('bill'); ?>';
    lang['print'] = '<?= lang('print'); ?>';
    lang['merchant_copy'] = '<?= lang('merchant_copy'); ?>';

    $(document).ready(function() {
        <?php if ($this->session->userdata('rmspos')) { ?>
            if (get('spositems')) { remove('spositems'); }
            if (get('spos_discount')) { remove('spos_discount'); }
            if (get('spos_tax')) { remove('spos_tax'); }
            if (get('spos_note')) { remove('spos_note'); }
            if (get('spos_customer')) { remove('spos_customer'); }
            if (get('amount')) { remove('amount'); }
            <?php $this->tec->unset_data('rmspos'); } ?>

            if (get('rmspos')) {
                if (get('spositems')) { remove('spositems'); }
                if (get('spos_discount')) { remove('spos_discount'); }
                if (get('spos_tax')) { remove('spos_tax'); }
                if (get('spos_note')) { remove('spos_note'); }
                if (get('spos_customer')) { remove('spos_customer'); }
                if (get('amount')) { remove('amount'); }
                remove('rmspos');
            }
            <?php if ($sid) { ?>

                store('spositems', JSON.stringify(<?=$items;?>));
                store('spos_discount', '<?=$suspend_sale->order_discount_id;?>');
                store('spos_tax', '<?=$suspend_sale->order_tax_id;?>');
                store('spos_customer', '<?=$suspend_sale->customer_id;?>');
                $('#spos_customer').select2().select2('val', '<?=$suspend_sale->customer_id;?>');
                store('rmspos', '1');
                $('#tax_val').val('<?=$suspend_sale->order_tax_id;?>');
                $('#discount_val').val('<?=$suspend_sale->order_discount_id;?>');
                <?php } elseif ($eid) { ?>
                    $('#date').inputmask("y-m-d h:s:s", { "placeholder": "YYYY/MM/DD HH:mm:ss" });
                    store('spositems', JSON.stringify(<?=$items;?>));
                    store('spos_discount', '<?=$sale->order_discount_id;?>');
                    store('spos_tax', '<?=$sale->order_tax_id;?>');
                    store('spos_customer', '<?=$sale->customer_id;?>');
                    store('sale_date', '<?=$sale->date;?>');
                    $('#spos_customer').select2().select2('val', '<?=$sale->customer_id;?>');
                    $('#date').val('<?=$sale->date;?>');
                    store('rmspos', '1');
                    $('#tax_val').val('<?=$sale->order_tax_id;?>');
                    $('#discount_val').val('<?=$sale->order_discount_id;?>');
                    <?php } else { ?>
                        if (! get('spos_discount')) {
                            store('spos_discount', '<?=@default_discount;?>');
                            $('#discount_val').val('<?=@default_discount;?>');
                        }
                        if (! get('spos_tax')) {
                            store('spos_tax', '<?=@default_tax_rate;?>');
                            $('#tax_val').val('<?=@default_tax_rate;?>');
                        }
                        <?php } ?>

                        if (ots = get('spos_tax')) {
                            $('#tax_val').val(ots);
                        }
                        if (ods = get('spos_discount')) {
                            $('#discount_val').val(ods);
                        }
                        bootbox.addLocale('bl',{OK:'<?= lang('ok'); ?>',CANCEL:'<?= lang('no'); ?>',CONFIRM:'<?= lang('yes'); ?>'});
                        bootbox.setDefaults({closeButton:false,locale:"bl"});
                        <?php if ($eid) { ?>
                            $('#suspend').attr('disabled', true);
                            $('#print_order').attr('disabled', true);
                            $('#print_bill').attr('disabled', true);
                            <?php } ?>
                        });
    </script>

    <script type="text/javascript">
                        var socket = null;
                        <?php
                        if (@remote_printing == 2) {
                            ?>
                            try {
                                socket = new WebSocket('ws://127.0.0.1:6441');
                                socket.onopen = function () {
                                    console.log('Connected');
                                    return;
                                };
                                socket.onclose = function () {
                                    console.log('Connection closed');
                                    return;
                                };
                            } catch (e) {
                                console.log(e);
                            }
                            <?php
                        }
                        ?>
                        function printBill(bill) {
                            if (Settings.remote_printing == 1) {
                                Popup($('#bill_tbl').html(), 'bill');
                            } else if (Settings.remote_printing == 2) {
                                if (socket.readyState == 1) {
                                    if (Settings.print_img == 1) {
                                        $('#bill-data').show();
                                        $('#preb').html(
                                            '<pre style="background:#FFF;font-size:20px;margin:0;border:0;color:#000 !important;">' +
                                            bill_data.info +
                                            bill_data.items +
                                            '\n' +
                                            bill_data.totals +
                                            '</pre>'
                                            );
                                        var element = $('#bill-data').get(0);
                                        html2canvas(element, {scrollY: 0, scale: 1.7}).then(function(canvas) {
                                            var dataURL = canvas.toDataURL();
                                            var socket_data = {
                                                'printer': <?= @local_printers ? "''" : json_encode($printer); ?>,
                                                'text': dataURL, 'cash_drawer': 0
                                            };
                                            socket.send(JSON.stringify({
                                                type: 'print-img',
                                                data: socket_data
                                            }));
                                            // return Canvas2Image.saveAsPNG(canvas);
                                        });
                                        setTimeout(function() {
                                            $('#bill-data').hide();
                                        }, 500);
                                    } else {
                                        var socket_data = {'printer': <?= @local_printers ? "''" : json_encode($printer); ?>, 'logo': '<?= !empty($store->logo) ? base_url('uploads/' . $store->logo) : ''; ?>', 'text': bill};
                                        socket.send(JSON.stringify({
                                            type: 'print-receipt',
                                            data: socket_data
                                        }));
                                    }
                                    return false;
                                } else {
                                    bootbox.alert('<?= lang('pos_print_error'); ?>');
                                    return false;
                                }
                            }
                        }
                        var order_printers = <?= @local_printers ? "''" : json_encode($order_printers); ?>;
                        function printOrder(order) {
                            if (Settings.remote_printing == 1) {
                                Popup($('#order_tbl').html(), 'order');
                            } else if (Settings.remote_printing == 2) {
                                if (socket.readyState == 1) {
                                    if (Settings.print_img == 1) {
                                        $('#order-data').show();
                                        $('#preo').html(
                                            '<pre style="background:#FFF;font-size:20px;margin:0;border:0;color:#000 !important;">' + order_data.info + order_data.items + '</pre>'
                                            );
                                        var element = $('#order-data').get(0);
                                        html2canvas(element, {scrollY: 0, scale: 1.7}).then(function(canvas) {
                                            var dataURL = canvas.toDataURL();
                                            var socket_data = {
                                                'printer': <?= @local_printers ? "''" : json_encode($printer); ?>,
                                                'text': dataURL, 'order': 1, 'cash_drawer': 0
                                            };
                                            socket.send(JSON.stringify({
                                                type: 'print-img',
                                                data: socket_data
                                            }));
                                            // return Canvas2Image.saveAsPNG(canvas);
                                        });
                                        setTimeout(function() {
                                            $('#order-data').hide();
                                        }, 500);
                                    } else {
                                        if (order_printers == '') {
                                            var socket_data = { 'printer': false, 'order': true,
                                            'logo': '<?= !empty($store->logo) ? base_url('uploads/' . $store->logo) : ''; ?>',
                                            'text': order };
                                            socket.send(JSON.stringify({type: 'print-receipt', data: socket_data}));
                                        } else {
                                            $.each(order_printers, function() {
                                                var socket_data = {'printer': this, 'logo': '<?= !empty($store->logo) ? base_url('uploads/' . $store->logo) : ''; ?>', 'text': order};
                                                socket.send(JSON.stringify({type: 'print-receipt', data: socket_data}));
                                            });
                                        }
                                    }
                                    return false;
                                } else {
                                    bootbox.alert('<?= lang('pos_print_error'); ?>');
                                    return false;
                                }
                            }
                        }
    </script>
    <?php
    if (isset($print) && !empty($print)) {
    /* include FCPATH.'themes'.DIRECTORY_SEPARATOR.$Settings->theme.DIRECTORY_SEPARATOR.'views'.DIRECTORY_SEPARATOR.'pos'.DIRECTORY_SEPARATOR.'remote_printing.php'; */
    include 'remote_printing.php';
    }
    ?>

    <script src="@(assets)dist/js/libraries.min.js" type="text/javascript"></script>
    <script src="@(assets)dist/js/scripts.min.js" type="text/javascript"></script>
    <script src="@(assets)dist/js/pos.min.js" type="text/javascript"></script>
    <?php if (@remote_printing != 1 && @print_img) { ?>
    <script src="@(assets)dist/js/htmlimg.js"></script>
    <?php } ?>
</body>
</html>
